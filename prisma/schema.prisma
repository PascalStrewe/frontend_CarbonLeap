// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                  Int                  @id @default(autoincrement())
  email               String               @unique
  password            String
  isAdmin             Boolean              @default(false)
  domain              Domain               @relation(fields: [domainId], references: [id])
  domainId            Int
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  interventionRequests InterventionRequest[]
}

model Domain {
  id            Int            @id @default(autoincrement())
  name          String         @unique
  companyName   String
  users         User[]
  interventions Intervention[]
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model Intervention {
  id        Int      @id @default(autoincrement())
  domain    Domain   @relation(fields: [domainId], references: [id])
  domainId  Int
}

model InterventionRequest {
  id                      String    @id @default(cuid())
  userId                  Int       // Made required by removing the ? 
  companyDomain          String
  intervention           String
  modality               String
  vesselType            String?
  geography             String
  lowCarbonFuelLiters    String?
  lowCarbonFuelMT       String?
  scope3EmissionsAbated  String?
  ghgEmissionSaving      String
  vintage                String
  lowCarbonFuel         String
  feedstock              String
  causality              String
  additionality          String
  thirdPartyVerification String
  certificationScheme    String
  otherCertificationScheme String?
  standards              String
  status                 String
  notificationSent       Boolean    @default(false)
  submissionDate         DateTime   @default(now())
  reviewedAt            DateTime?
  reviewedBy            String?
  comments              String?
  
  user                  User       @relation(fields: [userId], references: [id])

  @@index([status])
  @@index([companyDomain])
}